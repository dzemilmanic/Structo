document.addEventListener("DOMContentLoaded",function(){E();const h=document.querySelectorAll(".edit-toggle"),w=document.querySelectorAll(".cancel-edit");h.forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-field");S();const o=document.getElementById(`edit-form-${t}`),i=document.getElementById(`display-${t}`);if(o){if(o.style.display="block",o.classList.add("show"),i&&i.closest(".profile-display")&&(i.closest(".profile-display").style.display="none"),t==="photo"){const c=document.querySelector(".profile-photo-container");c&&(c.style.display="none")}const n=o.querySelector('input:not([type="hidden"]), textarea');n&&setTimeout(()=>n.focus(),100)}})}),w.forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-field"),o=s("confirmation",{title:"Cancel Changes?",text:"Are you sure you want to cancel your changes?",confirmButtonText:"Yes, cancel",cancelButtonText:"No, continue"});typeof Swal<"u"?Swal.fire(o).then(i=>{i.isConfirmed&&(r(t),d("Changes have been cancelled.","Cancelled"))}):confirm("Are you sure you want to cancel your changes?")&&r(t)})});function S(){document.querySelectorAll(".profile-edit-form").forEach(i=>{i.style.display="none",i.classList.remove("show")}),document.querySelectorAll(".profile-display").forEach(i=>{i.style.display="flex"});const o=document.querySelector(".profile-photo-container");o&&(o.style.display="flex")}function r(e){const t=document.getElementById(`edit-form-${e}`),o=document.getElementById(`display-${e}`);if(t){if(t.style.display="none",t.classList.remove("show"),o&&o.closest(".profile-display")&&(o.closest(".profile-display").style.display="flex"),e==="photo"){const n=document.querySelector(".profile-photo-container");n&&(n.style.display="flex")}t.querySelectorAll('input:not([type="hidden"]), textarea').forEach(n=>{n.hasAttribute("data-original-value")&&(n.value=n.getAttribute("data-original-value")||"")})}}document.querySelectorAll(".profile-edit-form form").forEach(e=>{e.addEventListener("submit",function(t){var g;t.preventDefault();const o=this.querySelector('button[type="submit"]'),i=o.textContent;o.textContent="Updating...",o.disabled=!0;const n=s("loading",{title:"Updating Profile...",text:"Please wait while we update your information.",didOpen:()=>{typeof Swal<"u"&&Swal.showLoading()}});typeof Swal<"u"&&Swal.fire(n);const c=new FormData(this);fetch(this.action,{method:"POST",body:c,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"))||c.get("_token")}}).then(f=>{if(f.ok)return f.text();throw new Error("Network response was not ok")}).then(f=>{typeof Swal<"u"&&Swal.close(),u("Profile updated successfully."),setTimeout(()=>{window.location.reload()},3e3)}).catch(f=>{typeof Swal<"u"&&Swal.close(),o.textContent=i,o.disabled=!1,a("An error occurred while updating your profile. Please try again.")})})}),document.addEventListener("keydown",function(e){if(e.key==="Escape"){const t=document.querySelector(".profile-edit-form.show");if(t){const o=t.id.replace("edit-form-",""),i=s("confirmation",{title:"Cancel Changes?",text:"You pressed Escape. Do you want to cancel your changes?",confirmButtonText:"Yes, cancel",cancelButtonText:"No, continue"});typeof Swal<"u"?Swal.fire(i).then(n=>{n.isConfirmed&&r(o)}):confirm("You pressed Escape. Do you want to cancel your changes?")&&r(o)}}});const m=document.getElementById("photo");m&&m.addEventListener("change",function(e){const t=e.target.files[0];if(t){if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(t.type)){a("Please select a valid image file (JPEG, PNG, JPG, GIF)","Invalid File Type"),this.value="";return}if(t.size>2097152){a("File size must be less than 2MB","File Too Large"),this.value="";return}d(`Selected image: ${t.name}`,"File Selected")}});const l=document.getElementById("bio");if(l){let e=function(){l.style.height="auto",l.style.height=l.scrollHeight+"px"};var B=e;l.addEventListener("input",e),l.addEventListener("focus",e),e()}const p={clean:{icon:!1,iconHtml:"",buttonsStyling:!0,allowOutsideClick:!0,allowEscapeKey:!0,showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}},confirmation:{showCancelButton:!0,reverseButtons:!0,focusCancel:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"},success:{confirmButtonColor:"#28a745",timer:3e3,timerProgressBar:!0,showCancelButton:!1},error:{confirmButtonColor:"#dc3545",showCancelButton:!1},loading:{allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1}};function s(e,t={}){const o={...p.clean},i=p[e]||{};return{...o,...i,...t}}function u(e){if(console.log("üì¢ Showing success message:",e),typeof Swal>"u"){alert(e);return}const t=s("success",{title:"Success!",text:e});Swal.fire(t)}function a(e,t="Error"){if(console.log("‚ö†Ô∏è Showing error message:",e),typeof Swal>"u"){alert(e);return}const o=s("error",{title:t,text:e});Swal.fire(o)}function d(e,t="Information"){if(console.log("‚ÑπÔ∏è Showing info message:",e),typeof Swal>"u"){alert(e);return}const o=s("clean",{title:t,text:e,confirmButtonColor:"#007bff",showCancelButton:!1});Swal.fire(o)}function y(e,t="Warning"){if(console.log("‚ö†Ô∏è Showing warning message:",e),typeof Swal>"u"){alert(e);return}const o=s("clean",{title:t,text:e,confirmButtonColor:"#ffc107",showCancelButton:!1});Swal.fire(o)}function E(){console.log("üîç Checking for profile session messages...");const e=document.querySelector("[data-session-success]");if(e){const n=e.getAttribute("data-session-success");n&&(console.log("‚úÖ Found session success message:",n),u(n))}const t=document.querySelector("[data-session-error]");if(t){const n=t.getAttribute("data-session-error");n&&(console.log("‚ùå Found session error message:",n),a(n))}const o=document.querySelector("[data-session-info]");if(o){const n=o.getAttribute("data-session-info");n&&(console.log("‚ÑπÔ∏è Found session info message:",n),d(n))}const i=document.querySelector("[data-session-warning]");if(i){const n=i.getAttribute("data-session-warning");n&&(console.log("‚ö†Ô∏è Found session warning message:",n),y(n))}}window.showSuccess=u,window.showError=a,window.showInfo=d,window.showWarning=y,window.createModalConfig=s});
