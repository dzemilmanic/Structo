class H{constructor(){this.init()}init(){document.addEventListener("click",n=>{var i;const s=n.target.closest(".delete-question-form"),r=n.target.closest(".delete-btn");if(s&&r){n.preventDefault(),n.stopPropagation();const u=((i=document.querySelector(".question-detail-title"))==null?void 0:i.textContent)||"this question";this.showDeleteConfirmation(s,u)}})}showDeleteConfirmation(n,s){typeof Swal<"u"?this.showSweetAlertDeleteConfirmation(n,s):confirm(`Are you sure you want to delete "${s}"? This question and all its answers will be permanently deleted. This action cannot be undone!`)&&n.submit()}showSweetAlertDeleteConfirmation(n,s){Swal.fire({title:"Delete Question?",text:`Are you sure you want to delete "${s}"? This question and all its answers will be permanently deleted. This action cannot be undone!`,showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Delete Question",cancelButtonText:"Cancel",reverseButtons:!0,focusCancel:!0,allowOutsideClick:!0,allowEscapeKey:!0,buttonsStyling:!0,icon:!1,iconHtml:"",showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}}).then(r=>{r.isConfirmed&&(Swal.fire({title:"Deleting Question...",text:"Please wait while we delete the question.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,icon:!1,didOpen:()=>{Swal.showLoading()}}),n.submit())}).catch(r=>{console.error("SweetAlert error:",r),confirm(`Are you sure you want to delete "${s}"? This question and all its answers will be permanently deleted. This action cannot be undone!`)&&n.submit()})}}class P{constructor(){this.init()}init(){document.addEventListener("click",n=>{var i;const s=n.target.closest(".delete-answer-form"),r=n.target.closest(".delete-btn");if(s&&r){n.preventDefault(),n.stopPropagation();const u=n.target.closest(".answer-card"),f=((i=u==null?void 0:u.querySelector(".answer-author"))==null?void 0:i.textContent)||"this answer";this.showDeleteConfirmation(s,f)}})}showDeleteConfirmation(n,s){typeof Swal<"u"?this.showSweetAlertDeleteConfirmation(n,s):confirm(`Are you sure you want to delete the answer by ${s}? This action cannot be undone and will permanently remove the answer.`)&&n.submit()}showSweetAlertDeleteConfirmation(n,s){Swal.fire({title:"Delete Answer?",text:`Are you sure you want to delete the answer by ${s}? This action cannot be undone and will permanently remove the answer.`,showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Delete Answer",cancelButtonText:"Cancel",reverseButtons:!0,focusCancel:!0,allowOutsideClick:!0,allowEscapeKey:!0,buttonsStyling:!0,icon:!1,iconHtml:"",showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}}).then(r=>{r.isConfirmed&&(Swal.fire({title:"Deleting Answer...",text:"Please wait while we delete the answer.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,icon:!1,didOpen:()=>{Swal.showLoading()}}),n.submit())}).catch(r=>{console.error("SweetAlert error:",r),confirm(`Are you sure you want to delete the answer by ${s}? This action cannot be undone and will permanently remove the answer.`)&&n.submit()})}}const Q={clean:{icon:!1,iconHtml:"",buttonsStyling:!0,allowOutsideClick:!0,allowEscapeKey:!0,showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}},confirmation:{showCancelButton:!0,reverseButtons:!0,focusCancel:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"},success:{confirmButtonColor:"#28a745",timer:3e3,timerProgressBar:!0,showCancelButton:!1},error:{confirmButtonColor:"#dc3545",showCancelButton:!1},loading:{allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1}};function w(o,n={}){const s={...Q.clean},r=Q[o]||{};return{...s,...r,...n}}function F(o){if(console.log("📢 Showing success message:",o),typeof Swal>"u"){alert(o);return}const n=w("success",{title:"Success!",text:o});Swal.fire(n)}function O(o){if(console.log("⚠️ Showing error message:",o),typeof Swal>"u"){alert(o);return}const n=w("error",{title:"Error",text:o});Swal.fire(n)}function U(o,n="Information"){if(console.log("ℹ️ Showing info message:",o),typeof Swal>"u"){alert(o);return}const s=w("clean",{title:n,text:o,confirmButtonColor:"#007bff",showCancelButton:!1});Swal.fire(s)}function $(o,n="Warning"){if(console.log("⚠️ Showing warning message:",o),typeof Swal>"u"){alert(o);return}const s=w("clean",{title:n,text:o,confirmButtonColor:"#ffc107",showCancelButton:!1});Swal.fire(s)}function R(){console.log("🔍 Checking for Q&A session messages...");const o=document.querySelector("[data-session-success]");if(o){const i=o.getAttribute("data-session-success");i&&(console.log("✅ Found session success message:",i),F(i))}const n=document.querySelector("[data-session-error]");if(n){const i=n.getAttribute("data-session-error");i&&(console.log("❌ Found session error message:",i),O(i))}const s=document.querySelector("[data-session-info]");if(s){const i=s.getAttribute("data-session-info");i&&(console.log("ℹ️ Found session info message:",i),U(i))}const r=document.querySelector("[data-session-warning]");if(r){const i=r.getAttribute("data-session-warning");i&&(console.log("⚠️ Found session warning message:",i),$(i))}}document.addEventListener("DOMContentLoaded",function(){new H,new P,R();const o=document.querySelector(".search-input"),n=document.querySelector(".search-form");let s,r=!1;o&&n&&(o.addEventListener("input",function(e){const t=e.target.value.trim();s&&clearTimeout(s),s=setTimeout(()=>{(t.length>=2||t.length===0)&&i(t)},300)}),n.addEventListener("submit",function(e){if(o.value.trim()===""){e.preventDefault(),o.focus();return}}));function i(e){var c;if(r)return;r=!0,u();const t=new URL(window.location.href);e?t.searchParams.set("search",e):t.searchParams.delete("search");const a=(c=document.getElementById("sortSelect"))==null?void 0:c.value;a&&t.searchParams.set("sort",a),fetch(t.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/html"}}).then(d=>d.text()).then(d=>{const x=new DOMParser().parseFromString(d,"text/html"),D=x.querySelector(".question-list"),A=document.querySelector(".question-list");D&&A&&(A.innerHTML=D.innerHTML,y());const I=x.querySelector(".results-info"),M=document.querySelector(".results-info");I&&M&&(M.innerHTML=I.innerHTML),window.history.pushState({},"",t.toString()),f(),r=!1}).catch(d=>{console.error("Search error:",d),f(),r=!1})}function u(){const e=document.querySelector(".search-btn");if(e){e.style.opacity="0.6",e.style.pointerEvents="none";const a=e.innerHTML;e.innerHTML=`
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 6v6l4 2"></path>
                </svg>
            `,e.dataset.originalContent=a}const t=document.querySelector(".question-list");t&&(t.style.opacity="0.7",t.style.pointerEvents="none")}function f(){const e=document.querySelector(".search-btn");e&&e.dataset.originalContent&&(e.innerHTML=e.dataset.originalContent,e.style.opacity="",e.style.pointerEvents="",delete e.dataset.originalContent);const t=document.querySelector(".question-list");t&&(t.style.opacity="",t.style.pointerEvents="")}function y(){document.querySelectorAll(".question-card").forEach(t=>{t.addEventListener("click",function(a){if(a.target.tagName==="A"||a.target.closest("a"))return;const c=t.getAttribute("data-url");c&&(window.location.href=c)})})}y();const g=document.querySelector(".sort-select");if(g&&g.addEventListener("change",function(){var a;const e=new URL(window.location.href);e.searchParams.set("sort",this.value);const t=(a=o==null?void 0:o.value)==null?void 0:a.trim();t&&e.searchParams.set("search",t),window.location.href=e.toString()}),!document.querySelector("#qa-search-styles")){const e=document.createElement("style");e.id="qa-search-styles",e.textContent=`
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
            
            .search-input:focus {
                border-color: var(--primary-color);
                box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
            }
            
            .question-list {
                transition: opacity 0.2s ease;
            }
            
            .search-btn {
                transition: opacity 0.2s ease;
            }
        `,document.head.appendChild(e)}const p=document.querySelectorAll(".answer-link");p.length>0&&p.forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const a=this.getAttribute("href"),c=document.querySelector(a);c&&window.scrollTo({top:c.offsetTop-100,behavior:"smooth"})})});const S=document.querySelectorAll("textarea");S.length>0&&S.forEach(e=>{const t=document.createElement("div");t.className="form-text text-right",t.textContent=`${e.value.length} characters`,e.parentNode.appendChild(t),e.addEventListener("input",function(){t.textContent=`${this.value.length} characters`})});const C=document.querySelectorAll(".alert");C.length>0&&C.forEach(e=>{setTimeout(()=>{e.style.opacity="0",e.style.transition="opacity 0.5s",setTimeout(()=>{e.style.display="none"},500)},5e3)});function B(){Swal.fire({title:"Login Required",text:"You must be logged in to ask a question.",icon:!1,showCancelButton:!0,confirmButtonColor:"#FF6B35",cancelButtonColor:"#6c757d",confirmButtonText:"Go to Login",cancelButtonText:"Cancel",reverseButtons:!0}).then(e=>{e.isConfirmed&&(window.location.href="/login")})}const v=document.getElementById("askQuestionBtnGuest"),E=document.getElementById("askQuestionBtnEmptyGuest");v&&v.addEventListener("click",function(e){e.preventDefault(),B()}),E&&E.addEventListener("click",function(e){e.preventDefault(),B()});const l=document.getElementById("askQuestionModal"),L=document.getElementById("askQuestionBtn"),b=document.getElementById("askQuestionBtnEmpty"),q=document.getElementById("modalCancelBtn"),k=document.querySelector(".modal-close"),m=document.getElementById("askQuestionForm");function T(){if(!l){console.error("Modal element not found!");return}l.classList.remove("show"),l.style.display="none",l.offsetHeight,l.style.display="flex",l.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"),setTimeout(()=>{const e=document.getElementById("modal-title");e&&e.focus()},100)}function h(){l&&(l.classList.remove("show"),setTimeout(()=>{l.style.display="none",document.body.style.overflow="",document.body.classList.remove("modal-open"),m&&m.reset(),_()},300))}function _(){const e=document.getElementById("title-error"),t=document.getElementById("content-error"),a=document.getElementById("modal-title"),c=document.getElementById("modal-content");e&&(e.style.display="none"),t&&(t.style.display="none"),a&&a.classList.remove("is-invalid"),c&&c.classList.remove("is-invalid")}L&&L.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),T()}),b&&b.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),T()}),q&&q.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),h()}),k&&k.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),h()}),l&&l.addEventListener("click",function(e){e.target===l&&h()}),document.addEventListener("keydown",function(e){e.key==="Escape"&&l&&l.classList.contains("show")&&h()}),m&&m.addEventListener("submit",function(e){const t=this.querySelector('button[type="submit"]');if(t){t.disabled=!0;const a=t.innerHTML;t.innerHTML="Posting...",setTimeout(()=>{t.disabled&&(t.disabled=!1,t.innerHTML=a)},5e3)}_()}),console.log("Q&A JS with clean delete confirmations and jobs-style notifications initialized successfully")});
