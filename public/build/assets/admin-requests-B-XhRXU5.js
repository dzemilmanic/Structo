class f{constructor(){this.init()}init(){document.addEventListener("click",e=>{if(e.target.classList.contains("approve-btn")||e.target.closest(".approve-btn")){e.preventDefault();const t=e.target.classList.contains("approve-btn")?e.target:e.target.closest(".approve-btn"),n=t.getAttribute("data-request-id"),o=t.getAttribute("data-user-name");this.showApproveConfirmation(n,o)}})}showApproveConfirmation(e,t){typeof Swal<"u"?this.showSweetAlertApproveConfirmation(e,t):confirm(`Are you sure you want to approve ${t}'s professional request? This will upgrade their account to professional status.`)&&this.submitApproveForm(e)}showSweetAlertApproveConfirmation(e,t){Swal.fire({title:"Approve Professional Request?",text:`Are you sure you want to approve ${t}'s professional request? This will upgrade their account to professional status.`,showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Approve Request",cancelButtonText:"Cancel",reverseButtons:!0,focusCancel:!0,allowOutsideClick:!0,allowEscapeKey:!0,buttonsStyling:!0,icon:!1,iconHtml:"",showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}}).then(n=>{n.isConfirmed&&(Swal.fire({title:"Approving Request...",text:"Please wait while we process the professional request approval.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,icon:!1,didOpen:()=>{Swal.showLoading()}}),this.submitApproveForm(e))}).catch(n=>{console.error("SweetAlert error:",n),confirm(`Are you sure you want to approve ${t}'s professional request? This will upgrade their account to professional status.`)&&this.submitApproveForm(e)})}submitApproveForm(e){const t=document.getElementById(`approve-form-${e}`);t?t.submit():(console.error("Approve form not found for request ID:",e),Swal.fire({title:"Error",text:"Form not found. Please refresh the page and try again.",icon:!1,confirmButtonText:"OK",confirmButtonColor:"#dc3545"}))}}class m{constructor(){this.init()}init(){document.addEventListener("click",e=>{if(e.target.classList.contains("reject-btn")||e.target.closest(".reject-btn")){e.preventDefault();const t=e.target.classList.contains("reject-btn")?e.target:e.target.closest(".reject-btn"),n=t.getAttribute("data-request-id"),o=t.getAttribute("data-user-name");this.showRejectConfirmation(n,o)}})}showRejectConfirmation(e,t){typeof Swal<"u"?this.showSweetAlertRejectConfirmation(e,t):confirm(`Are you sure you want to reject ${t}'s professional request? This action cannot be undone and all uploaded files will be permanently deleted.`)&&this.submitRejectForm(e)}showSweetAlertRejectConfirmation(e,t){Swal.fire({title:"Reject Professional Request?",text:`Are you sure you want to reject ${t}'s professional request? This action cannot be undone and all uploaded files will be permanently deleted.`,showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, Reject Request",cancelButtonText:"Cancel",reverseButtons:!0,focusCancel:!0,allowOutsideClick:!0,allowEscapeKey:!0,buttonsStyling:!0,icon:!1,iconHtml:"",showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}}).then(n=>{n.isConfirmed&&(Swal.fire({title:"Rejecting Request...",text:"Please wait while we process the request rejection.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,icon:!1,didOpen:()=>{Swal.showLoading()}}),this.submitRejectForm(e))}).catch(n=>{console.error("SweetAlert error:",n),confirm(`Are you sure you want to reject ${t}'s professional request? This action cannot be undone and all uploaded files will be permanently deleted.`)&&this.submitRejectForm(e)})}submitRejectForm(e){const t=document.getElementById(`reject-form-${e}`);t?t.submit():(console.error("Reject form not found for request ID:",e),Swal.fire({title:"Error",text:"Form not found. Please refresh the page and try again.",icon:!1,confirmButtonText:"OK",confirmButtonColor:"#dc3545"}))}}const u={clean:{icon:!1,iconHtml:"",buttonsStyling:!0,allowOutsideClick:!0,allowEscapeKey:!0,showClass:{popup:"animate__animated animate__fadeInDown animate__faster"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}},confirmation:{showCancelButton:!0,reverseButtons:!0,focusCancel:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"},success:{confirmButtonColor:"#28a745",timer:3e3,timerProgressBar:!0,showCancelButton:!1},error:{confirmButtonColor:"#dc3545",showCancelButton:!1},loading:{allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1}};function i(s,e={}){const t={...u.clean},n=u[s]||{};return{...t,...n,...e}}function p(s){if(console.log("ðŸ“¢ Showing success message:",s),typeof Swal>"u"){alert(s);return}const e=i("success",{title:"Success!",text:s});Swal.fire(e)}function g(s){if(console.log("âš ï¸ Showing error message:",s),typeof Swal>"u"){alert(s);return}const e=i("error",{title:"Error",text:s});Swal.fire(e)}function w(s,e="Information"){if(console.log("â„¹ï¸ Showing info message:",s),typeof Swal>"u"){alert(s);return}const t=i("clean",{title:e,text:s,confirmButtonColor:"#007bff",showCancelButton:!1});Swal.fire(t)}function h(s,e="Warning"){if(console.log("âš ï¸ Showing warning message:",s),typeof Swal>"u"){alert(s);return}const t=i("clean",{title:e,text:s,confirmButtonColor:"#ffc107",showCancelButton:!1});Swal.fire(t)}function b(){console.log("ðŸ” Checking for admin requests session messages...");const s=document.querySelector("[data-session-success]");if(s){const o=s.getAttribute("data-session-success");o&&(console.log("âœ… Found session success message:",o),p(o))}const e=document.querySelector("[data-session-error]");if(e){const o=e.getAttribute("data-session-error");o&&(console.log("âŒ Found session error message:",o),g(o))}const t=document.querySelector("[data-session-info]");if(t){const o=t.getAttribute("data-session-info");o&&(console.log("â„¹ï¸ Found session info message:",o),w(o))}const n=document.querySelector("[data-session-warning]");if(n){const o=n.getAttribute("data-session-warning");o&&(console.log("âš ï¸ Found session warning message:",o),h(o))}}class y{constructor(){this.modal=null,this.init()}init(){document.addEventListener("click",e=>{if(e.target.classList.contains("view-btn")||e.target.closest(".view-btn")){e.preventDefault(),e.stopPropagation();const t=e.target.classList.contains("view-btn")?e.target:e.target.closest(".view-btn"),n=t.getAttribute("data-image-src"),o=t.getAttribute("data-file-name");this.openImageModal(n,o)}}),document.addEventListener("click",e=>{if(e.target.classList.contains("download-btn")||e.target.closest(".download-btn")){const n=(e.target.classList.contains("download-btn")?e.target:e.target.closest(".download-btn")).getAttribute("href");n&&this.isImageFile(n)&&(e.preventDefault(),e.stopPropagation(),this.forceDownloadImage(n))}})}isImageFile(e){const t=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],n=e.toLowerCase();return t.some(o=>n.includes(o))}forceDownloadImage(e){const t=document.createElement("a");t.href=e;const n=e.split("/"),o=n[n.length-1]||"image.jpg";t.download=o,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}openImageModal(e,t){this.modal=document.getElementById("imageModal");const n=document.getElementById("modalImage"),o=document.getElementById("imageModalLabel");this.modal&&n&&(n.src=e,o&&(o.textContent=t||"Document Preview"),typeof bootstrap<"u"&&bootstrap.Modal?(new bootstrap.Modal(this.modal).show(),this.modal.addEventListener("hidden.bs.modal",()=>{this.cleanupModal()})):this.showFallbackModal())}showFallbackModal(){this.modal.style.display="block",this.modal.classList.add("show"),document.body.classList.add("modal-open");const e=document.createElement("div");e.className="modal-backdrop fade show",e.id="imageModalBackdrop",document.body.appendChild(e),this.modal.querySelectorAll('[data-bs-dismiss="modal"], .btn-close').forEach(a=>{a.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.closeImageModal()})}),this.modal.addEventListener("click",a=>{a.target===this.modal&&(a.preventDefault(),a.stopPropagation(),this.closeImageModal())});const n=this.modal.querySelector(".modal-content");n&&n.addEventListener("click",a=>{a.stopPropagation()});const o=a=>{a.key==="Escape"&&(this.closeImageModal(),document.removeEventListener("keydown",o))};document.addEventListener("keydown",o)}closeImageModal(){if(this.modal){this.modal.style.display="none",this.modal.classList.remove("show"),document.body.classList.remove("modal-open");const e=document.getElementById("imageModalBackdrop");e&&e.remove(),this.cleanupModal()}}cleanupModal(){if(this.modal){const e=document.getElementById("modalImage");e&&(e.src="")}}}let r,l,c;window.confirmApprove=function(s,e){r&&r.showApproveConfirmation(s,e)};window.confirmReject=function(s,e){l&&l.showRejectConfirmation(s,e)};window.openImageModal=function(s,e){c&&c.openImageModal(s,e)};document.addEventListener("DOMContentLoaded",function(){r=new f,l=new m,c=new y,b(),document.querySelectorAll("form").forEach(t=>{t.addEventListener("submit",function(){t.querySelectorAll('button[type="submit"]').forEach(o=>{o.disabled=!0;const a=o.innerHTML;o.innerHTML='<svg class="animate-spin" width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg> Processing...',setTimeout(()=>{o.disabled=!1,o.innerHTML=a},1e4)})})}),document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",function(n){n.preventDefault();const o=document.querySelector(this.getAttribute("href"));o&&o.scrollIntoView({behavior:"smooth",block:"start"})})});const e=document.querySelectorAll(".alert");e.length>0&&e.forEach(t=>{setTimeout(()=>{t.style.opacity="0",t.style.transition="opacity 0.5s",setTimeout(()=>{t.style.display="none"},500)},5e3)}),console.log("Admin Requests JS with clean confirmations and jobs-style notifications initialized successfully")});
